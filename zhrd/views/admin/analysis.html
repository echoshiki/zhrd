<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=7" />
<title>智慧网贷 </title>
<meta name="keywords" content=""/>
<meta name="description" content=""/>
<meta name="author" content="">
<link rel="stylesheet" href="<?php echo base_url('statics/css/cutter.css') ?>"> 
<script src="<?php echo base_url('statics/js/jquery-1.7.2.min.js') ?>"></script> 
<script src="<?php echo base_url('statics/js/cutter.js') ?>"></script> 
<!-- artDialog -->
<link  href="<?php echo base_url('statics/artDialog/skins/blue.css');?>" rel="stylesheet" />
<script src="<?php echo base_url('statics/artDialog/artDialog.source.js');?>" type="text/javascript"></script>

<script type="text/javascript" src="<?php echo base_url('statics/js/highcharts/js/highcharts.js'); ?>"></script>
<!-- <script type="text/javascript" src="../js/themes/gray.js"></script> -->
<!-- <script type="text/javascript" src="../js/modules/exporting.js"></script> -->
<style>
.zyc tr td{ text-align:center;}
</style>
</head>

<body class="usa" style="padding:10px; background-color:#E9EAED">
    <div class="righter">

          <div class="datatable">
       	    <div class="tip">
             	<div class="left">
                    <abbr> 统计分析</abbr>
					<a href="<?php echo site_url('admin/analysis');?>?pie=pie">饼状图分析</a>
                </div>
                <div class="right">
                  <a href="javascript:history.go(-1)" class="button deepblue">返回</a>
                </div>
            </div>
             <div class=" head" >
<div style="width:800px;margin:0 auto">
		企业规模：
		<select name="company" >
		<option value="small" <?php if( 'small' == $select['company']){ echo 'selected'; } ?> >小型企业</option>
		<option value="medium" <?php if( 'medium' == $select['company']){ echo 'selected'; } ?> >中型企业</option>

		</select>
		
		选择时间：
		<select name="start_year" >
		<option value="">--请选择--</option>
<?php for($a = 2013; $a<=2016; $a++) {?>
		<option value="<?php echo $a;?>" <?php if( $a == (int)$select['start_year']){ echo 'selected'; } ?> ><?php echo $a;?></option>
<?php } ?>
		</select>年
		
		<select name="start_month" >
		<option value="">--请选择--</option>
<?php for($a = 1; $a<=12; $a++) {?>
		<option value="<?php echo $a;?>" <?php if( $a == (int)$select['start_month']){ echo 'selected'; } ?> ><?php echo $a;?></option>
<?php } ?>
		</select>月
		--
		<select name="end_year" >
		<option value="">--请选择--</option>
<?php for($a = 2013; $a<=2016; $a++) {?>
		<option value="<?php echo $a;?>" <?php if( $a == (int)$select['end_year']){ echo 'selected'; } ?> ><?php echo $a;?></option>
<?php } ?>
		</select>年
		
		<select name="end_month" >
		<option value="">--请选择--</option>
<?php for($a = 1; $a<=12; $a++) {?>
		<option value="<?php echo $a;?>" <?php if( $a == (int)$select['end_month']){ echo 'selected'; } ?> ><?php echo $a;?></option>
<?php } ?>
		</select>月
		<a href="javascript:z()"  class='button deepblue small' title="查找">查询</a>
</div>
             </div>
             <div class="body">
						<div id="container" style="width: 800px; height: 400px; margin: 0 auto"></div>
						<div id="container2" style="width: 800px; height: 400px; margin: 0 auto"></div>
						

				<table border="0" class="table bordered zebra zyc" style="width:800px;margin:30px auto 0;text-align:center">
                      <tbody>
					  <tr>
						  <td rowspan="3">分<br>支<br>行</td><td colspan="3">申请阶段</td><td colspan="6">审核阶段</td><td colspan="8">审批阶段</td>
					  </tr>
					  <tr>
						  <td>完成注册</td>
						  <td colspan="2">完成申请</td>
						  <td colspan="2">审核中</td>
						  <td colspan="2">通过</td>
						  <td colspan="2">未通过</td>
						  <td colspan="2">未报批</td>
						  <td colspan="2">已报批</td>
						  <td colspan="2">通过</td>
						  <td colspan="2">未通过</td>
					  </tr>
					  <tr>
						  <td>客户数</td>
						  <td>客户数</td>
						  <td>金额(万元)</td>
						  <td>客户数</td>
						  <td>金额(万元)</td>
						  <td>客户数</td>
						  <td>金额(万元)</td>
						  <td>客户数</td>
						  <td>金额(万元)</td>
						  <td>客户数</td>
						  <td>金额(万元)</td>
						  <td>客户数</td>
						  <td>金额(万元)</td>
						  <td>客户数</td>
						  <td>金额(万元)</td>
						  <td>客户数</td>
						  <td>金额(万元)</td>
					  </tr>
<?php foreach($x as $k => $v){?>
					  <tr>
						  <td><?php echo $v['NAME']; ?></td>
						  <td><?php echo  $table[$k][0];?></td>
						  <td><?php echo  $table[$k][1];?></td>
						  <td><?php echo  $table[$k][2];?></td>
						  <td><?php echo  $table[$k][3];?></td>
						  <td><?php echo  $table[$k][4];?></td>
						  <td><?php echo  $table[$k][5];?></td>
						  <td><?php echo  $table[$k][6];?></td>
						  <td><?php echo  $table[$k][7];?></td>
						  <td><?php echo  $table[$k][8];?></td>
						  <td><?php echo  $table[$k][9];?></td>
						  <td><?php echo  $table[$k][10];?></td>
						  <td><?php echo  $table[$k][11];?></td>
						  <td><?php echo  $table[$k][12];?></td>
						  <td><?php echo  $table[$k][13];?></td>
						  <td><?php echo  $table[$k][14];?></td>
						  <td><?php echo  $table[$k][15];?></td>
						  <td><?php echo  $table[$k][16];?></td>
				
					  </tr>
<?php } ?>
<!--      合计    -->
						<tr>
							<td>合计</td>
<?php	foreach ($sum as $key => $value) { ?>
						<td><?php echo $value; ?></td>
<?php } ?>
						</tr>
          
                    </tbody>
				</table>
						
             </div>
				<div class="foot">
				</div>
          </div>
    </div>

	</body>
<script type="text/javascript">
function z(){
	var url = '<?php echo site_url('admin/analysis'); ?>';
	var redirect = url
				+'?company='+$("select[name='company']").val()
				+'&start_year='+$("select[name='start_year']").val()
				+'&start_month='+$("select[name='start_month']").val()
				+'&end_year='+$("select[name='end_year']").val()
				+'&end_month='+$("select[name='end_month']").val()
	// alert(redirect);
	window.location.href = redirect;
	// self.location = redirect;
	// window.open(redirect);
	// window.navigator(redirect);
}
		
		
			var chart;
			var chart2;
			$(document).ready(function() {
				chart = new Highcharts.Chart({
					chart: {
						renderTo: 'container',
						defaultSeriesType: 'column',
						margin: [ 50, 50, 100, 80]
					},
					title: {
						text: '苏州各地区的统计数量'
					},
					xAxis: {
						categories: [
<?php $num = count($x); foreach( $x as $k => $v){
echo '\''.$v['NAME'].'\'';echo ($num == $k+1)?"":",";
} ?>
						],
						labels: {
							rotation: -45,
							align: 'right',
							style: {
								 font: 'normal 13px Verdana, sans-serif'
							}
						}
					},
					yAxis: {
						min: 0,
						title: {
							text: '数量(个)'
						}
					},
					
					plotOptions: {
						bar: {
							dataLabels: {
								enabled: true
							}
						}
					},
				legend: {
						layout: 'vertical',
						backgroundColor: '#FFFFFF',
						align: 'right',
						verticalAlign: 'top',
						x: 10,
						y: 10,
						floating: true,
						shadow: true
					},
					tooltip: {
						formatter: function() {
							return '<b>'+ this.x +'</b><br/>'+
								 '数量: '+ Highcharts.numberFormat(this.y, 0);
						}
					},
				        series: [
						{
						name: '申请客户数',
						data: [
<?php $num = count($y[0]); foreach( $y[0] as $k => $v){
echo $v;echo ($num == $k+1)?"":",";
} ?>
							]
						},
						{
						name: '审核通过数',
						data: [
<?php $num = count($y[1]); foreach( $y[1] as $k => $v){
echo $v;echo ($num == $k+1)?"":",";
} ?>
							]
						},
						{
						name: '批复通过数',
						data: [
<?php $num = count($y[2]); foreach( $y[2] as $k => $v){
echo $v;echo ($num == $k+1)?"":",";
} ?>
							]
						},
						
					
					]
				});

				
				
				chart2 = new Highcharts.Chart({
					chart: {
						renderTo: 'container2',
						defaultSeriesType: 'column',
						margin: [ 50, 50, 100, 80]
					},
					title: {
						text: '苏州各地区的统计金额'
					},
					xAxis: {
						categories: [
<?php $num = count($x); foreach( $x as $k => $v){
echo '\''.$v['NAME'].'\'';echo ($num == $k+1)?"":",";
} ?>
						],
						labels: {
							rotation: -45,
							align: 'right',
							style: {
								 font: 'normal 13px Verdana, sans-serif'
							}
						}
					},
					yAxis: {
						min: 0,
						title: {
							text: '金额(万元)'
						}
					},
				legend: {
						layout: 'vertical',
						backgroundColor: '#FFFFFF',
						align: 'right',
						verticalAlign: 'top',
						x: 10,
						y: 10,
						floating: true,
						shadow: true
					},
					
					tooltip: {
						formatter: function() {
							return '<b>'+ this.x +'</b><br/>'+
								 '金额: '+ Highcharts.numberFormat(this.y, 0)+'(万元)';
						}
					},
				        series: [
						{
						name: '客户申请金额',
						data: [
<?php $num = count($y2[0]); foreach( $y2[0] as $k => $v){
echo $v;echo ($num == $k+1)?"":",";
} ?>
							]
						},
						{
						name: '审核通过金额',
						data: [
<?php $num = count($y2[1]); foreach( $y2[1] as $k => $v){
echo $v;echo ($num == $k+1)?"":",";
} ?>
							]
						},
						{
						name: '批复通过金额',
						data: [
<?php $num = count($y2[2]); foreach( $y2[2] as $k => $v){
echo $v;echo ($num == $k+1)?"":",";
} ?>
							]
						},
						
					
					]
				});
				
				
			});
		</script>
	
</html>